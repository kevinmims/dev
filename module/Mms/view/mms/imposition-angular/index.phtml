<?php 
//------ VIEW - imposition-angular/index.php test 
?>


<script>
	var app = angular.module('imposition', []);

	app.controller('MainController', function($scope, $http) {
	  $scope.message = "GitHub Viewer";
	  $scope.imgWidth = '125';
	  
	  
	  var onUserFound = function(response) {
	    //console.log(response.data);
	    $scope.user = response.data;
	    $http.get($scope.user.repos_url)
	      .then(onReposFound, onError);
	  };
	  
	  var onReposFound = function(response){
	    $scope.repos = response.data;
	  };
	  
	  var onError = function(reason) {
	    //$scope.errClass = 'alert alert-danger';
	    $scope.error = "Something is wrong";
	  };

	  $scope.search = function(searchUser){
	    $http.get("https://api.github.com/users/"+searchUser)
	    .then(onUserFound, onError);
	  };
	  
	  
	});
 
</script>


<div ng-app="imposition">
	<div ng-controller="MainController">
	  <div>
    <h1>{{message}}</h1>
    <div>{{error}}</div>
  </div>
 
  <div class="col-xs-12 " style="margin-bottom:25px;">
    <form name="searchUser" ng-submit="search(searchName)">
      <div class="input-group">
        <input type="search" required class="form-control" placeholder="enter user to find" ng-model="searchName">
        <span class="input-group-btn">
        <button type="submit"  class="btn btn-success" >Search</button>
      </span>
      </div>


    </form>
  </div>



  <div class="col-xs-3">
    <img style="width:100%" ng-src="{{user.avatar_url}}" title="" />
  </div>
  
  <div class="col-xs-9">
    
    <table class="table">
      <tr>
        <td>Name</td>
        <td><b>{{user.name}}</b></td>
      </tr>
      <tr>
        <td>Company</td>
        <td><b>{{user.company}}</b></td>
      </tr>
      <tr>
        <td>Location</td>
        <td><b>{{user.location}}</b></td>
      </tr>
    </table>

  </div>

  <div class="col-xs-12">
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Stars</th>
          <th>Language</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="repo in repos | orderBy: '-stargazers_count'">
          <td>{{repo.name}}</td>
          <td>{{repo.stargazers_count | number}}</td>
          <td>{{repo.language}}</td>
        </tr>
      </tbody>
    </table>
  </div>
	</div><!-- end, ng-controller -->
</div>
